<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login | Attendance Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: linear-gradient(135deg, #1e2937 0%, #334155 100%); }
        .glass { background: rgba(255,255,255,0.95); backdrop-filter: blur(20px); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center">
    <div class="glass w-full max-w-md mx-4 rounded-3xl shadow-2xl p-12 text-center">
        <div class="mx-auto w-24 h-24 bg-indigo-600 text-white rounded-3xl flex items-center justify-center text-5xl mb-8">
            <i class="fa-solid fa-shield-halved"></i>
        </div>
        <h1 class="text-4xl font-black tracking-tighter text-slate-900">Admin Portal</h1>
        <p class="text-slate-500 mt-3 text-lg">Secure HR Command Center Access</p>

        <button onclick="signInWithGoogle()" 
                class="mt-12 w-full flex items-center justify-center gap-4 bg-white hover:bg-gray-50 border border-slate-300 font-semibold text-lg py-6 rounded-2xl shadow-lg transition-all">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Google_%22G%22_logo.svg/768px-Google_%22G%22_logo.svg.png" class="w-7 h-7" alt="Google">
            Continue with Google
        </button>

        <p class="text-xs text-slate-400 mt-12">Only employees registered as **Admin** can enter</p>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAxBT0oESoL62oz_x_Z8cMtdENWZPx4tMI",
            authDomain: "pinotp-d7ef5.firebaseapp.com",
            databaseURL: "https://pinotp-d7ef5-default-rtdb.firebaseio.com",
            projectId: "pinotp-d7ef5",
            storageBucket: "pinotp-d7ef5.firebasestorage.app",
            messagingSenderId: "708458917827",
            appId: "1:708458917827:web:375de278577df0adcf9776"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        const provider = new firebase.auth.GoogleAuthProvider();

        function signInWithGoogle() {
            auth.signInWithPopup(provider).then(async (result) => {
                const user = result.user;
                const snap = await db.ref('employees').orderByChild('email').equalTo(user.email.toLowerCase()).once('value');
                let isAdmin = false;
                snap.forEach(child => { if (child.val().isAdmin === true) isAdmin = true; });

                if (isAdmin) {
                    window.location.href = "attendance-hub.html";
                } else {
                    await auth.signOut();
                    alert("Access Denied\\n\\nThis Google account is not registered as an Admin.");
                }
            }).catch(err => {
                alert("Sign-in failed: " + err.message);
            });
        }
    </script>
</body>
</html>
